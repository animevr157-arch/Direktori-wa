<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Direktori Saluran WhatsApp</title>
<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif;}
body{margin:0;background:#f2f4f8;}
header{background:#25D366;color:white;padding:20px;text-align:center;}
header h1{margin:0;font-size:26px;}
header p{margin-top:6px;opacity:0.9;}
.container{max-width:900px;margin:20px auto;padding:15px;}
.search-box{margin-bottom:20px;}
.search-box input{width:100%;padding:12px;font-size:16px;border-radius:8px;border:1px solid #ccc;}
.channel-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:15px;}
.card{background:white;border-radius:12px;padding:15px;box-shadow:0 4px 10px rgba(0,0,0,0.08);text-align:center;}
.card img{width:50px;height:50px;border-radius:50%;margin-bottom:10px;}
.card h3{margin:0 0 8px;}
.card p{font-size:14px;color:#555;}
.card a{display:inline-block;margin-top:10px;text-decoration:none;background:#25D366;color:white;padding:8px 12px;border-radius:6px;font-size:14px;}
.donate-popup{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);display:flex;justify-content:center;align-items:center;z-index:9999;}
.donate-box{background:#fff;padding:25px;border-radius:14px;max-width:400px;width:90%;text-align:center;position:relative;}
.donate-box span{position:absolute;top:10px;right:15px;font-size:22px;cursor:pointer;}
.donate-box a{display:inline-block;margin-top:15px;padding:10px 15px;background:#FF6B6B;color:white;border-radius:8px;text-decoration:none;font-weight:bold;}
footer{text-align:center;padding:15px;font-size:13px;color:#777;}
</style>
</head>
<body>

<!-- DONASI POPUP -->
<div id="donatePopup" class="donate-popup">
  <div class="donate-box">
    <span onclick="closeDonate()">✕</span>
    <h2>Selamat datang!</h2>
    <p>Kunjungi saluran WhatsApp utama:</p>
    <a href="https://whatsapp.com/channel/0029VbBS24J3gvWYXNUrRs45" target="_blank">Masuk Saluran</a>
    <p style="margin-top:15px;font-weight:bold;">DONASI</p>
    <a href="https://saweria.co/Animevora" target="_blank">Donasi Sekarang</a>
  </div>
</div>

<header>
  <h1>Direktori Saluran WhatsApp</h1>
  <p>Website publik untuk mencari & membagikan Saluran WhatsApp Indonesia</p>
</header>

<div class="container">
  <section style="background:#fff;padding:15px;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 10px rgba(0,0,0,0.08)">
    <h2>Submit Saluran WhatsApp</h2>
    <p>Saluran yang kamu submit akan LANGSUNG tampil untuk publik.</p>
    <input type="text" id="name" placeholder="Nama Saluran WhatsApp" style="width:100%;padding:10px;margin-bottom:8px" />
    <input type="text" id="desc" placeholder="Deskripsi singkat saluran" style="width:100%;padding:10px;margin-bottom:8px" />
    <input type="text" id="link" placeholder="Link Saluran WhatsApp" style="width:100%;padding:10px;margin-bottom:8px" />
    <input type="file" id="imgFile" accept="image/*" style="width:100%;margin-bottom:8px"/>
    <button onclick="addChannel()" style="padding:10px 15px;background:#25D366;color:#fff;border:none;border-radius:6px">Submit Saluran</button>
  </section>

  <div class="search-box">
    <input type="text" id="searchInput" placeholder="Cari berdasarkan nama atau deskripsi saluran" />
  </div>

  <div class="channel-list" id="channelList"></div>
</div>

<footer>© 2025 Direktori Saluran WhatsApp</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyA_0jv1f329SO8WOSSaasi5xOBIBjIvpIM",
  authDomain: "direktoriwa.firebaseapp.com",
  databaseURL: "https://direktoriwa-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "direktoriwa",
  storageBucket: "direktoriwa.firebasestorage.app",
  messagingSenderId: "1001709898104",
  appId: "1:1001709898104:web:8cccacd7a597883da1a08d",
  measurementId: "G-MN6H4XRX8W"
};
const app = firebase.initializeApp(firebaseConfig);
const analytics = firebase.analytics();
const db = firebase.database();
const storage = firebase.storage();

const channelList = document.getElementById('channelList');
const searchInput = document.getElementById('searchInput');

function addChannel(){
  const name = document.getElementById('name').value.trim();
  const desc = document.getElementById('desc').value.trim();
  const link = document.getElementById('link').value.trim();
  const file = document.getElementById('imgFile').files[0];

  if(!name||!desc||!link||!file){ alert('Semua field wajib diisi'); return;}
  if(!link.includes('whatsapp.com/channel')){ alert('Link WA harus valid'); return;}

  const storageRef = storage.ref('channelImages/'+Date.now()+'_'+file.name);
  storageRef.put(file).then(snapshot=>{
    snapshot.ref.getDownloadURL().then(url=>{
      db.ref('channels').push({name,desc,link,img:url});
      document.getElementById('name').value='';
      document.getElementById('desc').value='';
      document.getElementById('link').value='';
      document.getElementById('imgFile').value='';
    });
  });
}

// Tampilkan semua saluran dari Firebase
db.ref('channels').on('value', snapshot => {
  channelList.innerHTML = '';
  snapshot.forEach(snap => {
    const data = snap.val();
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <img src="${data.img}" alt="${data.name}">
      <h3>${data.name}</h3>
      <p>${data.desc}</p>
      <a href="${data.link}" target="_blank">Masuk Saluran</a>
    `;
    channelList.appendChild(div);
  });
});

// Search/filter saluran
searchInput.addEventListener('keyup', function(){
  const value = this.value.toLowerCase();
  document.querySelectorAll('.card').forEach(card=>{
    card.style.display = card.innerText.toLowerCase().includes(value)?'block':'none';
  });
});

// Tutup popup donasi
function closeDonate(){ document.getElementById('donatePopup').style.display='none'; }
</script>

</body>
</html>